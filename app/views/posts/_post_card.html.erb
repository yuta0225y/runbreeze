<!-- app/views/posts/_post_card.html.erb -->

<div class="card bg-base-100 shadow-xl flex flex-row p-4">
  <!-- 画像とカテゴリー -->
  <div class="w-1/4 relative mr-4">
    <% if post.post_image.present? %>
      <%= link_to post_path(post) do %>
        <%= image_tag(post.post_image.url, alt: post.title, class: "w-full h-full object-cover aspect-square") %>
      <% end %>
    <% else %>
      <%= link_to post_path(post) do %>
        <%= image_tag("default_post_image.jpg", alt: post.title, class: "w-full h-full object-cover aspect-square") %>
      <% end %>
    <% end %>

    <% if post.category.present? %>
      <div class="absolute top-0 left-0 bg-gray-800 text-white text-xs px-2 py-1 rounded-bl-lg">
        <%= post.category.name %>
      </div>
    <% end %>
  </div>

  <!-- コンテンツ部分 -->
  <div class="w-3/4">
    <!-- タグ -->
    <div class="flex flex-wrap space-x-2 mb-1">
      <% post.tags.each do |tag| %>
        <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">#<%= tag.name %></span>
      <% end %>
    </div>

    <!-- タイトル -->
    <h2 class="text-lg font-bold">
      <%= link_to post.title, post_path(post), class: "text-gray-800 hover:underline" %>
    </h2>

    <!-- 内容（概要表示） -->
    <p class="text-sm text-gray-600 line-clamp-2 mt-1">
      <%= link_to truncate(post.content, length: 100), post_path(post), class: "text-gray-600 hover:text-gray-800 hover:underline" %>
    </p>

    <!-- ユーザー情報とアクションボタン -->
    <div class="flex items-center justify-between mt-2">
      <!-- ユーザーアイコンと名前 -->
      <div class="flex items-center">
        <%= link_to user_profile_path(post.user), class: "flex items-center space-x-2" do %>
          <% if post.user.profile_image.present? %>
            <%= image_tag(post.user.profile_image.url, alt: post.user.username, class: "w-8 h-8 rounded-full") %>
          <% else %>
            <%= image_tag("default_profile_image.svg", alt: post.user.username, class: "w-8 h-8 rounded-full") %>
          <% end %>
          <span class="text-sm text-gray-700"><%= post.user.username %></span>
        <% end %>
      </div>

      <!-- アクションボタン（いいね・ブックマーク） -->
      <div class="flex items-center space-x-4">
        <!-- いいねボタン -->
        <%= render 'likes/like_buttons', post: post %>
        <!-- ブックマークボタン -->
        <%= render 'bookmarks/bookmark_buttons', post: post %>
      </div>
    </div>
  </div>
</div>
